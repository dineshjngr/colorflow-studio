<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ColorFlow Studio</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM (Pinned Stable Versions) -->
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Custom Scrollbar Hiding */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        /* Mask for Slider Fading */
        .mask-fade-sides {
            -webkit-mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
            mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
        }

        /* Glassmorphism Utilities */
        .glass-card {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .dark .glass-card {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Animations */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
    </style>
    
    <script>
        // Tailwind Configuration for Dark Mode
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Fira Code', 'monospace'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>
</head>
<body class="antialiased transition-colors duration-500">
    <div id="root"></div>

    <script type="text/babel">
        const apiKey = ""; // API key injected by environment

        /* --- 0. ICON DEFINITIONS (Embedded to remove external dependency) --- */
        
        const IconBase = ({ children, size = 24, className = "", ...props }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
                {...props}
            >
                {children}
            </svg>
        );

        const Copy = (props) => <IconBase {...props}><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></IconBase>;
        const RefreshCw = (props) => <IconBase {...props}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></IconBase>;
        const Share2 = (props) => <IconBase {...props}><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"/><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"/></IconBase>;
        const Palette = (props) => <IconBase {...props}><circle cx="13.5" cy="6.5" r=".5" fill="currentColor"/><circle cx="17.5" cy="10.5" r=".5" fill="currentColor"/><circle cx="8.5" cy="7.5" r=".5" fill="currentColor"/><circle cx="6.5" cy="12.5" r=".5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"/></IconBase>;
        const Layers = (props) => <IconBase {...props}><path d="m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"/><path d="m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"/><path d="m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"/></IconBase>;
        const Zap = (props) => <IconBase {...props}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></IconBase>;
        const Moon = (props) => <IconBase {...props}><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></IconBase>;
        const Sun = (props) => <IconBase {...props}><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></IconBase>;
        const Check = (props) => <IconBase {...props}><polyline points="20 6 9 17 4 12"/></IconBase>;
        const Droplet = (props) => <IconBase {...props}><path d="M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-7.406-1.104-1.932-3-4.594-4-4.594s-2.9 2.662-4 4.594C6 11.1 5 13 5 15a7 7 0 0 0 7 7z"/></IconBase>;
        const Grid = (props) => <IconBase {...props}><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M3 9h18"/><path d="M3 15h18"/><path d="M9 3v18"/><path d="M15 3v18"/></IconBase>;
        const Sliders = (props) => <IconBase {...props}><line x1="4" x2="4" y1="21" y2="14"/><line x1="4" x2="4" y1="10" y2="3"/><line x1="12" x2="12" y1="21" y2="12"/><line x1="12" x2="12" y1="8" y2="3"/><line x1="20" x2="20" y1="21" y2="16"/><line x1="20" x2="20" y1="12" y2="3"/><line x1="2" x2="6" y1="14" y2="14"/><line x1="10" x2="14" y1="8" y2="8"/><line x1="18" x2="22" y1="16" y2="16"/></IconBase>;
        const History = (props) => <IconBase {...props}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M12 7v5l4 2"/></IconBase>;
        const Maximize2 = (props) => <IconBase {...props}><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/></IconBase>;
        const Sparkles = (props) => <IconBase {...props}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 3v4"/><path d="M3 5h4"/><path d="M3 9h4"/></IconBase>;
        const Loader2 = (props) => <IconBase {...props}><path d="M21 12a9 9 0 1 1-6.219-8.56"/></IconBase>;
        const Wand2 = (props) => <IconBase {...props}><path d="m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z"/><path d="m14 7 3 3"/><path d="M5 6v4"/><path d="M19 14v4"/><path d="M10 2v2"/><path d="M7 8H3"/><path d="M21 16h-4"/><path d="M11 3H9"/></IconBase>;
        const BrainCircuit = (props) => <IconBase {...props}><path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/><path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"/><path d="M15 13a4.5 4.5 0 0 1-3-1.426A4.5 4.5 0 0 1 9 13"/><path d="M17.599 6.5a3 3 0 0 0 .399-1.375"/><path d="M6.003 5.125A3 3 0 0 0 6.401 6.5"/><path d="M3.477 10.896a4 4 0 0 1 .585-.396"/><path d="M19.938 10.5a4 4 0 0 1 .585.396"/><path d="M6 18a4 4 0 0 1-1.97-1.364"/><path d="M18 18a4 4 0 0 0 1.97-1.364"/></IconBase>;
        const Pipette = (props) => <IconBase {...props}><path d="M2 22h2"/><path d="M9 15l6-6"/><path d="M11 7l4 4"/><path d="m22 2-7 7.25a1 1 0 0 0-.29.76V14a1 1 0 0 1-.29.71l-2.42 2.42a1 1 0 0 1-1.41 0l-3.59-3.59a1 1 0 0 1 0-1.41l2.42-2.42a1 1 0 0 1 .71-.29h4.01c.28 0 .55-.11.75-.29L22 2z"/></IconBase>;
        const ChevronDown = (props) => <IconBase {...props}><path d="m6 9 6 6 6-6"/></IconBase>;
        const ChevronRight = (props) => <IconBase {...props}><path d="m9 18 6-6-6-6"/></IconBase>;
        const HelpCircle = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></IconBase>;
        const Search = (props) => <IconBase {...props}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></IconBase>;

        /* --- 1. UTILITY & COLOR MATH ENGINE --- */

        // Expanded Brand Data (30+ Brands)
        const BRAND_LOGOS = [
            { name: 'Spotify', hex: '#1DB954', icon: "S" },
            { name: 'Netflix', hex: '#E50914', icon: "N" },
            { name: 'Starbucks', hex: '#00704A', icon: "S" },
            { name: 'Facebook', hex: '#1877F2', icon: "f" },
            { name: 'McDonalds', hex: '#FFC72C', icon: "M" },
            { name: 'Google', hex: '#4285F4', icon: "G" },
            { name: 'Amazon', hex: '#FF9900', icon: "a" },
            { name: 'Apple', hex: '#555555', icon: "A" },
            { name: 'Microsoft', hex: '#F25022', icon: "M" },
            { name: 'Twitter', hex: '#1DA1F2', icon: "T" },
            { name: 'CocaCola', hex: '#F40009', icon: "C" },
            { name: 'Pepsi', hex: '#005CB4', icon: "P" },
            { name: 'IKEA', hex: '#FFCC00', icon: "I" },
            { name: 'Nike', hex: '#111111', icon: "N" },
            { name: 'Adidas', hex: '#000000', icon: "A" },
            { name: 'Samsung', hex: '#1428A0', icon: "S" },
            { name: 'Slack', hex: '#4A154B', icon: "S" },
            { name: 'Trello', hex: '#0079BF', icon: "T" },
            { name: 'Airbnb', hex: '#FF5A5F', icon: "A" },
            { name: 'Uber', hex: '#000000', icon: "U" },
            { name: 'Lyft', hex: '#FF00BF', icon: "L" },
            { name: 'Instagram', hex: '#E1306C', icon: "I" },
            { name: 'YouTube', hex: '#FF0000', icon: "Y" },
            { name: 'LinkedIn', hex: '#0077B5', icon: "L" },
            { name: 'Pinterest', hex: '#BD081C', icon: "P" },
            { name: 'WhatsApp', hex: '#25D366', icon: "W" },
            { name: 'Snapchat', hex: '#FFFC00', icon: "S" },
            { name: 'TikTok', hex: '#000000', icon: "T" },
            { name: 'Reddit', hex: '#FF4500', icon: "R" },
            { name: 'Discord', hex: '#5865F2', icon: "D" },
            { name: 'Twitch', hex: '#9146FF', icon: "T" },
            { name: 'Zoom', hex: '#2D8CFF', icon: "Z" },
        ];

        // Helper: Clamp values
        const clamp = (num, min, max) => Math.min(Math.max(num, min), max);

        // Helper: Parse Input to RGB
        const parseColorToRgb = (input) => {
            const div = document.createElement('div');
            div.style.color = 'black';
            div.style.color = input;
            document.body.appendChild(div);
            const computedColor = window.getComputedStyle(div).color;
            document.body.removeChild(div);
            
            if (!computedColor) return null;
            
            const match = computedColor.match(/rgba?\((\d+), (\d+), (\d+)/);
            if (match) {
                return { r: parseInt(match[1]), g: parseInt(match[2]), b: parseInt(match[3]) };
            }
            return null;
        };

        // Conversions
        const rgbToHex = (r, g, b) => {
            return "#" + [r, g, b].map(x => {
                const hex = x.toString(16);
                return hex.length === 1 ? '0' + hex : hex;
            }).join('').toUpperCase();
        };

        const hexToRgb = (hex) => {
            let result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        };

        const rgbToHsl = (r, g, b) => {
            r /= 255; g /= 255; b /= 255;
            const max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;

            if (max === min) {
                h = s = 0; 
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
            }
            return { h: Math.round(h * 360), s: Math.round(s * 100), l: Math.round(l * 100) };
        };

        const rgbToCmyk = (r, g, b) => {
            let c = 1 - (r / 255);
            let m = 1 - (g / 255);
            let y = 1 - (b / 255);
            let k = Math.min(c, Math.min(m, y));
            
            c = (c - k) / (1 - k);
            m = (m - k) / (1 - k);
            y = (y - k) / (1 - k);
            
            if (isNaN(c)) c = 0; if (isNaN(m)) m = 0; if (isNaN(y)) y = 0; if (isNaN(k)) k = 1;

            return {
                c: Math.round(c * 100),
                m: Math.round(m * 100),
                y: Math.round(y * 100),
                k: Math.round(k * 100)
            };
        };

        const rgbToHsv = (r, g, b) => {
            r /= 255; g /= 255; b /= 255;
            let max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, v = max;
            let d = max - min;
            s = max === 0 ? 0 : d / max;
            if (max === min) { h = 0; } else {
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
            }
            return { h: Math.round(h * 360), s: Math.round(s * 100), v: Math.round(v * 100) };
        };

        const hslToRgb = (h, s, l) => {
            let r, g, b;
            h /= 360; s /= 100; l /= 100;
            if (s === 0) {
                r = g = b = l; 
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            return { r: Math.round(r * 255), g: Math.round(g * 255), b: Math.round(b * 255) };
        };

        // Accessibility Math
        const getLuminance = (r, g, b) => {
            const a = [r, g, b].map((v) => {
                v /= 255;
                return v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4);
            });
            return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;
        };

        const getContrastRatio = (lum1, lum2) => {
            const brightest = Math.max(lum1, lum2);
            const darkest = Math.min(lum1, lum2);
            return (brightest + 0.05) / (darkest + 0.05);
        };

        /* --- 2. COMPONENTS --- */

        const GlassCard = ({ children, className = "", onClick, style }) => (
            <div 
                onClick={onClick}
                style={style}
                className={`
                    glass-card
                    shadow-[0_8px_32px_0_rgba(31,38,135,0.07)] 
                    rounded-3xl 
                    transition-all duration-300
                    hover:shadow-[0_8px_32px_0_rgba(31,38,135,0.15)]
                    hover:scale-[1.01]
                    ${className}
                `}
            >
                {children}
            </div>
        );

        const SectionTitle = ({ children, subtitle }) => (
            <div className="mb-8 text-center md:text-left">
                <h2 className="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-gray-900 to-gray-600 dark:from-white dark:to-gray-400">
                    {children}
                </h2>
                {subtitle && <p className="text-gray-500 dark:text-gray-400 mt-2">{subtitle}</p>}
            </div>
        );

        const CopyButton = ({ text, label = "" }) => {
            const [copied, setCopied] = React.useState(false);
            
            const handleCopy = (e) => {
                e.stopPropagation();
                try {
                    const textArea = document.createElement("textarea");
                    textArea.value = text;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    setCopied(true);
                    setTimeout(() => setCopied(false), 2000);
                } catch (err) {
                    console.error('Failed to copy', err);
                }
            };

            return (
                <button 
                    onClick={handleCopy}
                    className="group flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/50 dark:bg-black/50 hover:bg-white/80 dark:hover:bg-black/80 transition-all text-xs font-medium text-gray-700 dark:text-gray-200 border border-transparent hover:border-gray-200 dark:hover:border-gray-700"
                >
                    {copied ? <Check size={14} className="text-green-500" /> : <Copy size={14} />}
                    {label && <span>{copied ? "Copied" : label}</span>}
                </button>
            );
        };

        const ColorSwatch = ({ color, name, hex, subtext, size = "md", onClick }) => {
            const rgb = hexToRgb(hex) || {r:0, g:0, b:0};
            const lum = getLuminance(rgb.r, rgb.g, rgb.b);
            const textColor = lum > 0.5 ? 'text-black' : 'text-white';
            const subTextColor = lum > 0.5 ? 'text-black/60' : 'text-white/60';

            const sizeClasses = {
                sm: "h-24 text-xs",
                md: "h-32 text-sm",
                lg: "h-48 text-base",
            };

            return (
                <div 
                    onClick={onClick}
                    className={`relative group cursor-pointer overflow-hidden rounded-2xl shadow-sm transition-all duration-300 hover:scale-105 hover:shadow-xl ${sizeClasses[size]}`}
                    style={{ backgroundColor: hex }}
                >
                    <div className={`absolute bottom-0 left-0 w-full p-3 ${textColor} opacity-0 group-hover:opacity-100 transition-opacity flex flex-col justify-end bg-gradient-to-t from-black/20 to-transparent h-full`}>
                        <div className="font-bold">{name || hex}</div>
                        {subtext && <div className={`${subTextColor} text-xs`}>{subtext}</div>}
                        <div className="absolute top-2 right-2">
                            <CopyButton text={hex} />
                        </div>
                    </div>
                </div>
            );
        };

        const AccordionItem = ({ title, children }) => {
            const [isOpen, setIsOpen] = React.useState(false);
            return (
                <div className="border-b border-gray-200 dark:border-white/10 last:border-0">
                    <button 
                        onClick={() => setIsOpen(!isOpen)}
                        className="flex justify-between items-center w-full py-4 text-left font-medium text-gray-800 dark:text-gray-200 hover:text-purple-600 dark:hover:text-purple-400 transition-colors"
                    >
                        {title}
                        {isOpen ? <ChevronDown size={18} /> : <ChevronRight size={18} />}
                    </button>
                    {isOpen && (
                        <div className="pb-4 text-sm text-gray-500 dark:text-gray-400 leading-relaxed animate-in slide-in-from-top-2">
                            {children}
                        </div>
                    )}
                </div>
            );
        };

        /* --- 3. MAIN APPLICATION --- */

        function App() {
            const [inputStr, setInputStr] = React.useState('#F54927');
            const [activeColor, setActiveColor] = React.useState({ r: 245, g: 73, b: 39 });
            const [inputType, setInputType] = React.useState('HEX'); // HEX, RGB, HSL, CMYK
            const [darkMode, setDarkMode] = React.useState(false);
            const [history, setHistory] = React.useState([]);
            const [gradientSecondColor, setGradientSecondColor] = React.useState('#4F46E5');
            
            // AI State
            const [aiPrompt, setAiPrompt] = React.useState('');
            const [aiPalette, setAiPalette] = React.useState(null);
            const [isAiLoading, setIsAiLoading] = React.useState(false);
            const [aiInsight, setAiInsight] = React.useState(null);
            const [isInsightLoading, setIsInsightLoading] = React.useState(false);

            // Initialize and Routing
            React.useEffect(() => {
                const saved = localStorage.getItem('colorflow_history');
                if (saved) setHistory(JSON.parse(saved));
                if (window.location.hash) {
                    const hashColor = window.location.hash.replace('#', '#');
                    handleColorInput(hashColor);
                }
            }, []);

            // Derived Values
            const hex = React.useMemo(() => rgbToHex(activeColor.r, activeColor.g, activeColor.b), [activeColor]);
            const hsl = React.useMemo(() => rgbToHsl(activeColor.r, activeColor.g, activeColor.b), [activeColor]);
            const cmyk = React.useMemo(() => rgbToCmyk(activeColor.r, activeColor.g, activeColor.b), [activeColor]);
            const hsv = React.useMemo(() => rgbToHsv(activeColor.r, activeColor.g, activeColor.b), [activeColor]);
            
            const luminance = getLuminance(activeColor.r, activeColor.g, activeColor.b);
            const contrastWhite = getContrastRatio(luminance, 1.05);
            const contrastBlack = getContrastRatio(luminance, 0.05);
            const bestTextColor = contrastWhite > contrastBlack ? '#FFFFFF' : '#000000';
            const wcagStatus = (val) => val >= 7 ? "AAA" : val >= 4.5 ? "AA" : val >= 3 ? "AA Large" : "Fail";

            const handleColorInput = (val) => {
                setInputStr(val);
                const rgb = parseColorToRgb(val);
                if (rgb) {
                    setActiveColor(rgb);
                    addToHistory(rgb);
                    setAiInsight(null);
                }
            };

            const handleInputModeChange = (mode) => {
                setInputType(mode);
                // Convert current color to new format string
                if (mode === 'HEX') setInputStr(hex);
                if (mode === 'RGB') setInputStr(`rgb(${activeColor.r}, ${activeColor.g}, ${activeColor.b})`);
                if (mode === 'HSL') setInputStr(`hsl(${hsl.h}, ${hsl.s}%, ${hsl.l}%)`);
                if (mode === 'CMYK') setInputStr(`cmyk(${cmyk.c}%, ${cmyk.m}%, ${cmyk.y}%, ${cmyk.k}%)`);
            };

            const addToHistory = (rgb) => {
                const newHex = rgbToHex(rgb.r, rgb.g, rgb.b);
                setHistory(prev => {
                    if (prev.length > 0 && prev[0] === newHex) return prev;
                    const newList = [newHex, ...prev].slice(0, 10);
                    localStorage.setItem('colorflow_history', JSON.stringify(newList));
                    return newList;
                });
            };

            const setRandomColor = () => {
                const r = Math.floor(Math.random() * 255);
                const g = Math.floor(Math.random() * 255);
                const b = Math.floor(Math.random() * 255);
                const hex = rgbToHex(r,g,b);
                handleColorInput(hex);
                if(inputType !== 'HEX') handleInputModeChange(inputType);
            };

            // Harmonies Generator
            const harmonies = React.useMemo(() => {
                const baseH = hsl.h;
                const generate = (hOffset, sMult = 1, lMult = 1) => {
                    const newH = (baseH + hOffset) % 360;
                    const newS = clamp(hsl.s * sMult, 0, 100);
                    const newL = clamp(hsl.l * lMult, 0, 100);
                    const rgb = hslToRgb(newH, newS, newL);
                    return rgbToHex(rgb.r, rgb.g, rgb.b);
                };

                return {
                    complementary: [hex, generate(180)],
                    analogous: [generate(-30), hex, generate(30)],
                    triadic: [hex, generate(120), generate(240)],
                    splitComp: [hex, generate(150), generate(210)],
                    monochromatic: [
                        generate(0, 1, 1.5), 
                        generate(0, 1, 1.25), 
                        hex, 
                        generate(0, 1, 0.8), 
                        generate(0, 1, 0.6)
                    ],
                    tetradic: [hex, generate(90), generate(180), generate(270)]
                };
            }, [hsl, hex]);

            // Palettes Generator
            const palettes = React.useMemo(() => {
                const baseH = hsl.h;
                const gen = (h, s, l) => {
                    const rgb = hslToRgb(h % 360, clamp(s,0,100), clamp(l,0,100));
                    return rgbToHex(rgb.r, rgb.g, rgb.b);
                };
                
                return {
                    pastel: Array.from({length: 5}, (_, i) => gen(baseH + (i * 30), 70, 85)),
                    neon: Array.from({length: 5}, (_, i) => gen(baseH + (i * 45), 100, 50)),
                    material: Array.from({length: 5}, (_, i) => gen(baseH, 75, 90 - (i*15))),
                    shades: Array.from({length: 5}, (_, i) => gen(baseH, hsl.s, 95 - (i*20))),
                };
            }, [hsl]);

            // Best Combinations Generator
            const bestCombinations = React.useMemo(() => {
                const isLight = luminance > 0.5;
                
                // 1. High Contrast UI
                const textCol = isLight ? '#000000' : '#FFFFFF';
                const simple = { bg: hex, fg: textCol, name: 'High Contrast' };

                // 2. Brand Surface
                // If main color is light, use dark grey surface. If dark, use light grey.
                const surfaceHex = isLight ? '#1a1a1a' : '#f8f9fa';
                const surface = { bg: surfaceHex, fg: hex, name: 'Brand Accent' };

                // 3. Vibrant Pop (Complementary)
                const comp = harmonies.complementary[1];
                const vibrant = { bg: hex, fg: comp, name: 'Vibrant Duo' };

                // 4. Soft Monochrome (Subtle)
                // Use a soft shade as BG and main color as FG
                const softBg = harmonies.monochromatic[0];
                const soft = { bg: softBg, fg: hex, name: 'Soft Mono' };

                return [simple, surface, vibrant, soft];
            }, [hex, luminance, harmonies]);

            /* --- GEMINI API INTEGRATION --- */

            const callGemini = async (userPrompt, isJson = false) => {
                try {
                    const response = await fetch(
                        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,
                        {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                contents: [{ parts: [{ text: userPrompt }] }],
                                generationConfig: isJson ? { responseMimeType: "application/json" } : {}
                            }),
                        }
                    );
                    const data = await response.json();
                    return data.candidates?.[0]?.content?.parts?.[0]?.text;
                } catch (error) {
                    console.error("Gemini API Error:", error);
                    return null;
                }
            };

            const handleMagicPalette = async () => {
                if (!aiPrompt) return;
                setIsAiLoading(true);
                setAiPalette(null);

                const prompt = `Generate a JSON array of 5 distinct hex color codes that perfectly match this description: "${aiPrompt}". Return ONLY the valid JSON array (e.g. ["#ffffff", "#000000"]).`;
                
                const result = await callGemini(prompt, true);
                
                if (result) {
                    try {
                        const colors = JSON.parse(result);
                        if (Array.isArray(colors)) {
                            setAiPalette(colors);
                        }
                    } catch (e) {
                        console.error("Failed to parse JSON", e);
                    }
                }
                setIsAiLoading(false);
            };

            const handleColorInsight = async () => {
                setIsInsightLoading(true);
                const prompt = `You are a color psychology expert. Briefly describe the color ${hex} in 2-3 sentences. Mention its emotional vibe and a good use case for UI design. Keep it concise.`;
                const result = await callGemini(prompt);
                if (result) {
                    setAiInsight(result);
                }
                setIsInsightLoading(false);
            };

            const cssGradient = `linear-gradient(135deg, ${hex} 0%, ${gradientSecondColor} 100%)`;

            return (
                <div className={`min-h-screen font-sans selection:bg-pink-500 selection:text-white transition-colors duration-500 ${darkMode ? 'dark bg-gray-900 text-gray-100' : 'bg-gray-50 text-gray-800'}`}>
                    
                    {/* Background Ambience */}
                    <div className="fixed inset-0 overflow-hidden pointer-events-none z-0">
                        <div className="absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-purple-400/30 dark:bg-purple-900/30 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-[100px] opacity-70 animate-pulse-slow" />
                        <div className="absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-blue-400/30 dark:bg-blue-900/30 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-[100px] opacity-70 animate-pulse-slow" style={{animationDelay: '2s'}} />
                        <div className="absolute top-[20%] right-[20%] w-[30%] h-[30%] bg-pink-400/30 dark:bg-pink-900/30 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-[100px] opacity-70 animate-pulse-slow" style={{animationDelay: '4s'}} />
                    </div>

                    {/* Navbar */}
                    <nav className="fixed top-0 w-full z-50 px-6 py-4 flex justify-between items-center backdrop-blur-md bg-white/10 border-b border-white/20">
                        <div className="flex items-center gap-2">
                            <div className="w-8 h-8 rounded-lg bg-gradient-to-tr from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold animate-pulse">C</div>
                            <h1 className="text-xl font-black tracking-tight bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 bg-clip-text text-transparent animate-pulse duration-3000">
                                ColorFlow <span className="font-light opacity-70 text-gray-800 dark:text-gray-200">Studio</span>
                            </h1>
                        </div>
                        <div className="flex items-center gap-4">
                            <button onClick={() => setDarkMode(!darkMode)} className="p-2 rounded-full hover:bg-black/5 dark:hover:bg-white/10 transition">
                                {darkMode ? <Sun size={20} /> : <Moon size={20} />}
                            </button>
                        </div>
                    </nav>

                    {/* Main Content */}
                    <main className="relative z-10 pt-28 pb-20 px-4 md:px-8 max-w-7xl mx-auto space-y-16">

                        {/* Hero & Converter Section */}
                        <section className="grid lg:grid-cols-2 gap-12 items-start">
                            <div className="space-y-8">
                                <div className="space-y-4">
                                    <div className="inline-block px-3 py-1 rounded-full bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-300 text-xs font-bold uppercase tracking-wider">
                                        The Ultimate Color Tool
                                    </div>
                                    <h1 className="text-5xl md:text-6xl font-extrabold leading-tight tracking-tight">
                                        Explore Colors <br/>
                                        <span className="bg-clip-text text-transparent bg-gradient-to-r from-purple-600 to-pink-600 animate-pulse">Like Never Before</span>
                                    </h1>
                                    <p className="text-lg text-gray-500 dark:text-gray-400 max-w-md">
                                        Convert HEX, RGB, HSL instantly. Generate harmonies, accessibility checks, and stunning palettes in a premium glassmorphism interface.
                                    </p>
                                </div>

                                {/* Main Input Card */}
                                <GlassCard className="p-1.5">
                                    <div className="relative">
                                        {/* Input Mode Selector */}
                                        <div className="flex gap-2 p-2 pb-0">
                                            {['HEX', 'RGB', 'HSL', 'CMYK'].map(mode => (
                                                <button
                                                    key={mode}
                                                    onClick={() => handleInputModeChange(mode)}
                                                    className={`
                                                        px-3 py-1 rounded-full text-xs font-bold transition-all
                                                        ${inputType === mode 
                                                            ? 'bg-black text-white dark:bg-white dark:text-black shadow-md' 
                                                            : 'bg-transparent text-gray-500 hover:bg-gray-100 dark:hover:bg-white/10'}
                                                    `}
                                                >
                                                    {mode}
                                                </button>
                                            ))}
                                        </div>

                                        <div className="relative mt-2">
                                             <input 
                                                type="text" 
                                                value={inputStr}
                                                onChange={(e) => handleColorInput(e.target.value)}
                                                className="w-full h-16 pl-16 pr-16 rounded-2xl bg-transparent outline-none text-xl font-mono font-medium placeholder-gray-400"
                                                placeholder={`Enter ${inputType} code...`}
                                            />
                                            <div 
                                                className="absolute left-3 top-3 w-10 h-10 rounded-xl shadow-inner border border-black/5 transition-colors duration-300"
                                                style={{ backgroundColor: hex }}
                                            />
                                            
                                            {/* Color Picker & Random Button */}
                                            <div className="absolute right-3 top-3 flex gap-2">
                                                <div className="relative group">
                                                    <button className="p-2 rounded-lg bg-gray-100 dark:bg-white/10 hover:bg-gray-200 dark:hover:bg-white/20 transition text-gray-500">
                                                        <Pipette size={20} />
                                                    </button>
                                                    <input 
                                                        type="color" 
                                                        value={hex}
                                                        onChange={(e) => handleColorInput(e.target.value)}
                                                        className="absolute inset-0 opacity-0 cursor-pointer w-full h-full"
                                                    />
                                                </div>

                                                <button 
                                                    onClick={setRandomColor}
                                                    className="p-2 rounded-lg bg-gray-100 dark:bg-white/10 hover:bg-gray-200 dark:hover:bg-white/20 transition text-gray-500"
                                                    title="Random Color"
                                                >
                                                    <RefreshCw size={20} />
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </GlassCard>

                                {/* Formats Grid */}
                                <div className="grid grid-cols-2 gap-4">
                                    {[
                                        { label: 'HEX', val: hex },
                                        { label: 'RGB', val: `${activeColor.r}, ${activeColor.g}, ${activeColor.b}` },
                                        { label: 'HSL', val: `${hsl.h}°, ${hsl.s}%, ${hsl.l}%` },
                                        { label: 'CMYK', val: `${cmyk.c}, ${cmyk.m}, ${cmyk.y}, ${cmyk.k}` },
                                    ].map((fmt, idx) => (
                                        <GlassCard key={idx} className="p-4 flex flex-col justify-between group">
                                            <span className="text-xs uppercase font-bold text-gray-400 mb-1">{fmt.label}</span>
                                            <div className="flex justify-between items-end">
                                                <span className="font-mono text-sm md:text-base font-semibold truncate mr-2">{fmt.val}</span>
                                                <CopyButton text={fmt.val} />
                                            </div>
                                        </GlassCard>
                                    ))}
                                </div>
                            </div>

                            {/* Live Preview Pane */}
                            <div className="relative">
                                <GlassCard className="h-[500px] w-full flex flex-col items-center justify-center text-center p-8 transition-colors duration-500" style={{ backgroundColor: hex }}>
                                     {/* Preview Content */}
                                     <div className="space-y-4 max-w-sm">
                                        <h3 className="text-4xl font-bold transition-colors duration-300" style={{ color: bestTextColor }}>
                                            Aa
                                        </h3>
                                        <h4 className="text-2xl font-bold transition-colors duration-300" style={{ color: bestTextColor }}>
                                            Color Preview
                                        </h4>
                                        <p className="text-sm opacity-80 transition-colors duration-300" style={{ color: bestTextColor }}>
                                            This text automatically adjusts its contrast based on the background luminance to ensure WCAG compliance.
                                        </p>
                                        
                                        {/* AI Insight Button */}
                                        <div className="pt-4">
                                            {isInsightLoading ? (
                                                <div className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/20 backdrop-blur-md text-sm font-medium animate-pulse" style={{ color: bestTextColor }}>
                                                    <Loader2 size={16} className="animate-spin" /> Analyzing...
                                                </div>
                                            ) : aiInsight ? (
                                                <div className="text-left p-4 rounded-xl bg-white/20 backdrop-blur-md border border-white/10 text-sm animate-in fade-in slide-in-from-bottom-2">
                                                    <div className="flex items-center gap-2 mb-1 font-bold opacity-80" style={{ color: bestTextColor }}>
                                                        <BrainCircuit size={14} /> AI Analysis
                                                    </div>
                                                    <p style={{ color: bestTextColor }}>{aiInsight}</p>
                                                </div>
                                            ) : (
                                                <button 
                                                    onClick={handleColorInsight}
                                                    className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/20 hover:bg-white/30 backdrop-blur-md transition-all text-sm font-medium"
                                                    style={{ color: bestTextColor }}
                                                >
                                                    <Sparkles size={16} /> Ask AI about this color
                                                </button>
                                            )}
                                        </div>
                                     </div>

                                     {/* Accessibility Badge */}
                                     <div className="absolute bottom-6 right-6 flex gap-2">
                                        <div className="px-4 py-2 rounded-xl bg-black/20 backdrop-blur-md text-white text-xs font-bold border border-white/10">
                                            Contrast: {contrastWhite > contrastBlack ? contrastWhite.toFixed(2) : contrastBlack.toFixed(2)}:1
                                        </div>
                                        <div className={`px-4 py-2 rounded-xl backdrop-blur-md text-white text-xs font-bold border border-white/10 ${wcagStatus(Math.max(contrastWhite, contrastBlack)) === 'Fail' ? 'bg-red-500/50' : 'bg-green-500/50'}`}>
                                            WCAG {wcagStatus(Math.max(contrastWhite, contrastBlack))}
                                        </div>
                                     </div>
                                </GlassCard>
                                
                                {/* Share/Link Bubble */}
                                <div className="absolute -bottom-6 left-1/2 -translate-x-1/2">
                                    <GlassCard className="flex items-center gap-2 px-6 py-3 rounded-full shadow-2xl">
                                        <Share2 size={16} className="text-blue-500"/>
                                        <span className="text-xs font-medium text-gray-500">colorflow.studio/#{hex.replace('#','')}</span>
                                        <CopyButton text={`https://colorflow.studio/${hex}`} label="Link" />
                                    </GlassCard>
                                </div>
                            </div>
                        </section>

                        {/* AI MAGIC LAB SECTION */}
                        <section className="relative overflow-hidden">
                            <div className="absolute inset-0 bg-gradient-to-r from-purple-500/10 to-blue-500/10 rounded-3xl -z-10" />
                            <GlassCard className="p-8 border-2 border-purple-500/20">
                                <div className="flex flex-col md:flex-row gap-8">
                                    <div className="flex-1 space-y-4">
                                        <div className="flex items-center gap-2 mb-2">
                                            <span className="p-2 rounded-lg bg-gradient-to-br from-purple-500 to-indigo-600 text-white shadow-lg">
                                                <Sparkles size={20} />
                                            </span>
                                            <h2 className="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-600 to-indigo-600 dark:from-purple-400 dark:to-indigo-400">
                                                Magic AI Palette
                                            </h2>
                                        </div>
                                        <p className="text-gray-500 dark:text-gray-400">
                                            Describe a mood, scene, or memory (e.g., "Sunset in Santorini" or "Cyberpunk Tokyo Rain"), and our Gemini AI will generate the perfect palette.
                                        </p>
                                        
                                        <div className="relative">
                                            <input 
                                                type="text"
                                                value={aiPrompt}
                                                onChange={(e) => setAiPrompt(e.target.value)}
                                                onKeyDown={(e) => e.key === 'Enter' && handleMagicPalette()}
                                                placeholder="Enter a prompt..."
                                                className="w-full p-4 pr-32 rounded-xl bg-white/50 dark:bg-black/50 border border-gray-200 dark:border-white/10 outline-none focus:ring-2 focus:ring-purple-500/50 transition-all"
                                            />
                                            <button 
                                                onClick={handleMagicPalette}
                                                disabled={isAiLoading || !aiPrompt}
                                                className="absolute right-2 top-2 bottom-2 px-4 rounded-lg bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-medium text-sm hover:scale-105 active:scale-95 disabled:opacity-50 disabled:hover:scale-100 transition-all flex items-center gap-2 shadow-lg shadow-purple-500/30"
                                            >
                                                {isAiLoading ? <Loader2 size={16} className="animate-spin"/> : <Wand2 size={16}/>}
                                                Generate ✨
                                            </button>
                                        </div>
                                    </div>

                                    <div className="flex-1">
                                        {aiPalette ? (
                                            <div className="space-y-3 animate-in fade-in zoom-in duration-500">
                                                <h3 className="text-sm font-bold uppercase text-gray-400 tracking-wider">Generated Results</h3>
                                                <div className="grid grid-cols-5 gap-2 h-32">
                                                    {aiPalette.map((c, i) => (
                                                        <div 
                                                            key={i}
                                                            onClick={() => handleColorInput(c)}
                                                            className="h-full rounded-xl cursor-pointer hover:scale-110 hover:z-10 transition-transform shadow-md relative group"
                                                            style={{ backgroundColor: c }}
                                                        >
                                                            <div className="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity bg-black/20 rounded-xl">
                                                                <span className="text-[10px] font-bold text-white bg-black/50 px-1 py-0.5 rounded">{c}</span>
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                                <div className="flex justify-end">
                                                    <CopyButton text={aiPalette.join(', ')} label="Copy All" />
                                                </div>
                                            </div>
                                        ) : (
                                            <div className="h-full min-h-[160px] flex flex-col items-center justify-center text-center p-8 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-xl bg-white/10">
                                                <Palette size={32} className="text-gray-300 dark:text-gray-700 mb-2" />
                                                <p className="text-sm text-gray-400">Your AI-generated colors will appear here.</p>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </GlassCard>
                        </section>

                        {/* Brand Inspiration Slider Section */}
                        <section>
                             <SectionTitle subtitle="Scroll to explore 30+ iconic brand colors.">Brand Colors</SectionTitle>
                             <div className="relative group">
                                {/* Horizontal Slider Container */}
                                <div className="flex overflow-x-auto gap-4 pb-6 snap-x snap-mandatory scrollbar-hide mask-fade-sides">
                                    {BRAND_LOGOS.map((brand) => (
                                        <div key={brand.name} className="snap-center shrink-0">
                                             <GlassCard 
                                                onClick={() => handleColorInput(brand.hex)}
                                                className="w-32 h-32 flex flex-col items-center justify-center gap-3 group/card cursor-pointer hover:bg-white/60 dark:hover:bg-black/60 transition-all"
                                            >
                                                <div className="relative w-12 h-12 flex items-center justify-center rounded-full bg-white dark:bg-black/20 shadow-sm border border-black/5">
                                                    <div 
                                                        className="absolute inset-0 rounded-full opacity-20 blur-lg transition-all duration-300 group-hover/card:scale-125 group-hover/card:opacity-40"
                                                        style={{ backgroundColor: brand.hex }}
                                                    />
                                                    <span className="text-xl font-black relative z-10" style={{ color: brand.hex }}>{brand.icon}</span>
                                                </div>
                                                <div className="text-center">
                                                    <h4 className="font-bold text-xs text-gray-800 dark:text-gray-100">{brand.name}</h4>
                                                    <span className="text-[10px] font-mono text-gray-400">{brand.hex}</span>
                                                </div>
                                            </GlassCard>
                                        </div>
                                    ))}
                                </div>
                                {/* Visual indicator for scrolling */}
                                <div className="absolute right-0 top-0 bottom-6 w-12 bg-gradient-to-l from-gray-50 dark:from-gray-900 to-transparent pointer-events-none md:hidden" />
                             </div>
                        </section>

                        {/* Harmonies Section */}
                        <section>
                            <SectionTitle subtitle="Scientifically generated based on color theory.">Color Harmonies</SectionTitle>
                            <div className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
                                
                                {Object.entries(harmonies).map(([name, colors]) => (
                                    <GlassCard key={name} className="p-4 flex flex-col gap-3">
                                        <div className="flex justify-between items-center mb-1">
                                            <span className="capitalize font-bold text-gray-700 dark:text-gray-200">{name.replace(/([A-Z])/g, ' $1').trim()}</span>
                                            <Layers size={14} className="opacity-50"/>
                                        </div>
                                        <div className="flex h-24 rounded-xl overflow-hidden shadow-sm">
                                            {colors.map((c, i) => (
                                                <div 
                                                    key={i} 
                                                    onClick={() => handleColorInput(c)}
                                                    className="flex-1 h-full hover:flex-[1.5] transition-all cursor-pointer group relative"
                                                    style={{ backgroundColor: c }}
                                                >
                                                    <span className="absolute bottom-2 left-1/2 -translate-x-1/2 text-[10px] bg-black/50 text-white px-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap">
                                                        {c}
                                                    </span>
                                                </div>
                                            ))}
                                        </div>
                                        <div className="flex justify-between">
                                             <CopyButton text={colors.join(', ')} label="Copy Palette" />
                                        </div>
                                    </GlassCard>
                                ))}

                            </div>
                        </section>

                        {/* Generated Palettes Section */}
                        <section>
                            <SectionTitle subtitle="Curated styles for your next project.">Generated Palettes</SectionTitle>
                            <div className="space-y-8">
                                {Object.entries(palettes).map(([style, colors]) => (
                                    <div key={style}>
                                        <h3 className="capitalize text-lg font-semibold mb-3 ml-2 flex items-center gap-2">
                                            <Palette size={16} className="text-pink-500"/> {style} Style
                                        </h3>
                                        <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
                                            {colors.map((c, i) => (
                                                <ColorSwatch key={i} hex={c} name={style} subtext={c} onClick={() => handleColorInput(c)} />
                                            ))}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </section>

                        {/* Best Combinations Section */}
                        <section>
                            <SectionTitle subtitle="Hand-picked pairings for UI designs.">Best Combinations</SectionTitle>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                {bestCombinations.map((combo, i) => (
                                    <GlassCard key={i} className="overflow-hidden group cursor-pointer" onClick={() => handleColorInput(combo.fg)}>
                                        <div 
                                            className="h-32 flex flex-col items-center justify-center transition-colors duration-500" 
                                            style={{ backgroundColor: combo.bg, color: combo.fg }}
                                        >
                                            <h4 className="text-2xl font-bold">Aa</h4>
                                            <p className="text-xs font-medium opacity-80 mt-1">{combo.name}</p>
                                        </div>
                                        <div className="p-3 bg-white/50 dark:bg-black/50 flex justify-between items-center text-xs">
                                            <div className="flex gap-2">
                                                <div className="flex flex-col">
                                                    <span className="text-[10px] uppercase opacity-50">BG</span>
                                                    <span className="font-mono">{combo.bg}</span>
                                                </div>
                                                <div className="flex flex-col">
                                                    <span className="text-[10px] uppercase opacity-50">FG</span>
                                                    <span className="font-mono">{combo.fg}</span>
                                                </div>
                                            </div>
                                            <CopyButton text={`${combo.bg}, ${combo.fg}`} label="Copy" />
                                        </div>
                                    </GlassCard>
                                ))}
                            </div>
                        </section>

                        {/* Gradient Creator */}
                        <section>
                            <SectionTitle subtitle="Build smooth CSS gradients.">Gradient Builder</SectionTitle>
                            <GlassCard className="p-8">
                                <div className="grid md:grid-cols-2 gap-12 items-center">
                                    {/* Gradient Preview */}
                                    <div 
                                        className="h-64 w-full rounded-3xl shadow-xl flex items-center justify-center relative overflow-hidden"
                                        style={{ background: cssGradient }}
                                    >
                                         <div className="bg-black/20 backdrop-blur-sm text-white px-4 py-2 rounded-lg text-sm font-mono">
                                            .my-gradient
                                         </div>
                                    </div>

                                    {/* Controls */}
                                    <div className="space-y-6">
                                        <div className="flex items-center gap-4">
                                            <div className="flex-1 space-y-2">
                                                <label className="text-xs font-bold uppercase text-gray-400">Start Color</label>
                                                <div className="flex items-center gap-2 p-2 bg-white/50 dark:bg-black/50 rounded-xl border border-gray-200 dark:border-gray-700">
                                                    <div className="w-8 h-8 rounded-lg shadow-sm" style={{backgroundColor: hex}}></div>
                                                    <input 
                                                        type="text" 
                                                        value={hex} 
                                                        readOnly
                                                        className="bg-transparent font-mono text-sm w-full outline-none"
                                                    />
                                                </div>
                                            </div>
                                            <div className="text-gray-400"><Sliders size={20}/></div>
                                            <div className="flex-1 space-y-2">
                                                <label className="text-xs font-bold uppercase text-gray-400">End Color</label>
                                                <div className="flex items-center gap-2 p-2 bg-white/50 dark:bg-black/50 rounded-xl border border-gray-200 dark:border-gray-700">
                                                    <div className="w-8 h-8 rounded-lg shadow-sm" style={{backgroundColor: gradientSecondColor}}></div>
                                                    <input 
                                                        type="text" 
                                                        value={gradientSecondColor} 
                                                        onChange={(e) => setGradientSecondColor(e.target.value)}
                                                        className="bg-transparent font-mono text-sm w-full outline-none"
                                                    />
                                                </div>
                                            </div>
                                        </div>

                                        <div className="p-4 rounded-xl bg-gray-900 text-gray-200 font-mono text-xs overflow-x-auto relative group">
                                            <code>background: {cssGradient};</code>
                                            <div className="absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity">
                                                <CopyButton text={`background: ${cssGradient};`} />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </GlassCard>
                        </section>

                        {/* SEO & FAQ Section */}
                        <section className="py-12 border-t border-gray-200 dark:border-white/5">
                             <div className="grid md:grid-cols-2 gap-16">
                                <div className="space-y-8 text-gray-600 dark:text-gray-300">
                                    <div>
                                        <h3 className="text-2xl font-bold text-gray-900 dark:text-white mb-4">What Is a Color Converter?</h3>
                                        <p className="leading-relaxed">A color converter is a simple online tool that helps designers, developers and digital creators switch any color code into the format they need. Most design systems use different formats, so converting colors becomes important. A designer may work in HEX, a developer may need RGB or HSL, and a brand guide may require CMYK. A good converter solves all of this instantly.</p>
                                    </div>
                                    <div>
                                        <h3 className="text-xl font-bold text-gray-900 dark:text-white mb-3">Why Online Color Conversion Matters</h3>
                                        <p className="leading-relaxed">Modern projects move through many tools. A color chosen in Figma or Webflow might be needed later in a CSS file or within a JavaScript function. Without a converter, you would need to calculate every value manually. This website removes all manual work and shows every format side by side.</p>
                                    </div>
                                    <div>
                                        <h3 className="text-xl font-bold text-gray-900 dark:text-white mb-3">Supported Color Formats</h3>
                                        <ul className="list-disc pl-5 space-y-1">
                                            <li>HEX (Hexadecimal)</li>
                                            <li>RGB (Red, Green, Blue)</li>
                                            <li>HSL (Hue, Saturation, Lightness)</li>
                                            <li>CMYK (Cyan, Magenta, Yellow, Key)</li>
                                            <li>HSV & Named CSS Colors</li>
                                        </ul>
                                    </div>
                                </div>

                                <div className="space-y-8">
                                     <div className="bg-white/50 dark:bg-black/20 p-6 rounded-3xl border border-gray-100 dark:border-white/5">
                                        <h3 className="flex items-center gap-2 text-xl font-bold text-gray-900 dark:text-white mb-6">
                                            <HelpCircle size={20}/> Frequently Asked Questions
                                        </h3>
                                        <div className="space-y-2">
                                            <AccordionItem title="How do I convert HEX to RGB?">
                                                Simply enter your HEX code (e.g., #F54927) into the main input field above. The tool will instantly calculate and display the corresponding RGB values in the format block below.
                                            </AccordionItem>
                                            <AccordionItem title="Can I generate a palette from one color?">
                                                Yes! Once you enter a color, scroll down to the "Generated Palettes" section. We automatically create Pastel, Neon, Material Design, and Shade variations for you.
                                            </AccordionItem>
                                            <AccordionItem title="Is this tool free to use?">
                                                Absolutely. ColorFlow Studio is 100% free for designers, developers, and creators. You can use it for personal or commercial projects without limits.
                                            </AccordionItem>
                                            <AccordionItem title="Does it support CMYK for print?">
                                                Yes, we provide an approximate CMYK conversion suitable for design reference. Always check with your printer for exact color matching requirements.
                                            </AccordionItem>
                                        </div>
                                     </div>
                                     <div className="text-gray-600 dark:text-gray-300">
                                        <h3 className="text-xl font-bold text-gray-900 dark:text-white mb-3">Perfect for Web Projects</h3>
                                        <p className="leading-relaxed">This converter helps you build consistent color palettes. You can generate tints, shades, matching tones and complementary pairs based on any starting color. Everything is calculated live and shown in clear cards.</p>
                                     </div>
                                </div>
                             </div>
                        </section>

                        {/* Footer / History */}
                        <footer className="border-t border-gray-200 dark:border-white/10 pt-12 pb-24">
                            <div className="flex flex-col md:flex-row justify-between items-start gap-8">
                                <div>
                                    <h4 className="font-bold text-lg mb-2 flex items-center gap-2"><History size={18}/> Recent History</h4>
                                    <div className="flex flex-wrap gap-2">
                                        {history.length === 0 && <span className="text-sm text-gray-400">No history yet.</span>}
                                        {history.map((h, i) => (
                                            <button 
                                                key={i}
                                                onClick={() => handleColorInput(h)}
                                                className="w-8 h-8 rounded-full border-2 border-white dark:border-gray-800 shadow-sm hover:scale-110 transition-transform"
                                                style={{ backgroundColor: h }}
                                                title={h}
                                            />
                                        ))}
                                    </div>
                                </div>
                                <div className="text-right text-sm text-gray-500">
                                    <p className="font-semibold text-gray-900 dark:text-white">ColorFlow Studio</p>
                                    <p>Built by DJ with ❤️</p>
                                    <p className="mt-2 text-xs opacity-60">Press 'C' to copy main color instantly.</p>
                                </div>
                            </div>
                        </footer>

                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
